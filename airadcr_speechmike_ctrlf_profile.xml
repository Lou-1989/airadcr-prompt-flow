<?xml version="1.0" encoding="utf-8"?>
<ApplicationControlConfiguration Version="9.0">
  <ApplicationProfileList>
    
    <!-- Profil par défaut : Dragon NaturallySpeaking -->
    <ApplicationProfile TargetApplication="" Active="True" Comment="Dragon NaturallySpeaking par défaut">
      <OperationList>
        <Operation Event="spmRecordPressed" ModifierKey="None">
          <Steps>
            <OperationElement Type="DragonCommand" DragonCommand="MicrophoneToggle" />
          </Steps>
        </Operation>
        <Operation Event="spmStopPressed" ModifierKey="None">
          <Steps>
            <OperationElement Type="DragonCommand" DragonCommand="MicrophoneOffStop" />
          </Steps>
        </Operation>
        <Operation Event="spmPlayPressed" ModifierKey="None">
          <Steps>
            <OperationElement Type="DragonCommand" DragonCommand="PlayFromCursor" />
          </Steps>
        </Operation>
        <Operation Event="spmRewindPressed" ModifierKey="None">
          <Steps>
            <OperationElement Type="DragonCommand" DragonCommand="RewindFromCursor" />
          </Steps>
        </Operation>
        <Operation Event="spmFastForwardPressed" ModifierKey="None">
          <Steps>
            <OperationElement Type="DragonCommand" DragonCommand="FastForwardFromCursor" />
          </Steps>
        </Operation>
      </OperationList>
    </ApplicationProfile>
    
    <!-- Profil spécifique : AIRADCR Desktop Application (VERSION 3.0 - Système unifié) -->
    <ApplicationProfile TargetApplication="airadcr-desktop.exe" Active="True" Comment="AIRADCR Desktop v3.0 - Système unifié Ctrl+Shift">
      <OperationList>
        
        <!-- ═══════════════════════════════════════════════════════════════ -->
        <!-- 🎤 CONTRÔLE DE DICTÉE (Ctrl+Shift+D/P)                         -->
        <!-- ═══════════════════════════════════════════════════════════════ -->
        
        <!-- Bouton Record : Ctrl+Shift+D (Démarrer/Terminer dictée) -->
        <Operation Event="spmRecordPressed" ModifierKey="None" Name="AIRADCR Start/Stop">
          <Steps>
            <OperationElement Type="Hotkey">
              <Hotkey Key="D" Modifiers="Control+Shift" />
            </OperationElement>
          </Steps>
          <Comment>
            Bouton Record du SpeechMike → Ctrl+Shift+D:
            Démarre ou termine la dictée (toggle intelligent)
          </Comment>
        </Operation>
        
        <!-- Bouton Stop : Ctrl+Shift+P (Pause/Reprise) -->
        <Operation Event="spmStopPressed" ModifierKey="None" Name="AIRADCR Pause/Resume">
          <Steps>
            <OperationElement Type="Hotkey">
              <Hotkey Key="P" Modifiers="Control+Shift" />
            </OperationElement>
          </Steps>
          <Comment>
            Bouton Stop du SpeechMike → Ctrl+Shift+P:
            Met en pause ou reprend l'enregistrement (toggle)
          </Comment>
        </Operation>
        
        <!-- Bouton Play : Ctrl+Shift+P (Alternative pour Reprise) -->
        <Operation Event="spmPlayPressed" ModifierKey="None" Name="AIRADCR Play/Continue">
          <Steps>
            <OperationElement Type="Hotkey">
              <Hotkey Key="P" Modifiers="Control+Shift" />
            </OperationElement>
          </Steps>
          <Comment>
            Bouton Play du SpeechMike → Ctrl+Shift+P:
            Reprend l'enregistrement (même action que Stop)
          </Comment>
        </Operation>
        
        <!-- ═══════════════════════════════════════════════════════════════ -->
        <!-- 📋 INJECTION DE TEXTE (Ctrl+Shift+T/S)                         -->
        <!-- ═══════════════════════════════════════════════════════════════ -->
        
        <!-- Bouton Instruction : Ctrl+Shift+T (Injecter texte brut - Insert) -->
        <Operation Event="spmInstructionPressed" ModifierKey="None" Name="AIRADCR Inject Raw">
          <Steps>
            <OperationElement Type="Hotkey">
              <Hotkey Key="T" Modifiers="Control+Shift" />
            </OperationElement>
          </Steps>
          <Comment>
            Bouton Instruction du SpeechMike → Ctrl+Shift+T:
            Injecte le texte brut depuis textarea dans le RIS
          </Comment>
        </Operation>
        
        <!-- Bouton Programmable 1 : Ctrl+Shift+S (Injecter rapport structuré - EOL) -->
        <Operation Event="spmProgrammable1Pressed" ModifierKey="None" Name="AIRADCR Inject Structured">
          <Steps>
            <OperationElement Type="Hotkey">
              <Hotkey Key="S" Modifiers="Control+Shift" />
            </OperationElement>
          </Steps>
          <Comment>
            Bouton Programmable 1 du SpeechMike → Ctrl+Shift+S:
            Injecte le rapport structuré complet (EOL)
          </Comment>
        </Operation>
        
        <!-- ═══════════════════════════════════════════════════════════════ -->
        <!-- 🔧 BOUTONS NON UTILISÉS (Désactivés)                           -->
        <!-- ═══════════════════════════════════════════════════════════════ -->
        
        <!-- Bouton Rewind : Désactivé pour AIRADCR -->
        <Operation Event="spmRewindPressed" ModifierKey="None" Name="AIRADCR Rewind (disabled)">
          <Steps>
            <OperationElement Type="NoAction" />
          </Steps>
          <Comment>
            Bouton Rewind du SpeechMike: Non utilisé dans AIRADCR v3.0
          </Comment>
        </Operation>
        
        <!-- Bouton Fast Forward : Désactivé pour AIRADCR -->
        <Operation Event="spmFastForwardPressed" ModifierKey="None" Name="AIRADCR FastForward (disabled)">
          <Steps>
            <OperationElement Type="NoAction" />
          </Steps>
          <Comment>
            Bouton Fast Forward du SpeechMike: Non utilisé dans AIRADCR v3.0
          </Comment>
        </Operation>
        
        <!-- ═══════════════════════════════════════════════════════════════ -->
        <!-- 🔘 BOUTONS F1-F4 (Fonction par défaut conservée)               -->
        <!-- ═══════════════════════════════════════════════════════════════ -->
        
        <Operation Event="spmF1Pressed" ModifierKey="None" Name="F1 Key">
          <Steps>
            <OperationElement Type="Hotkey">
              <Hotkey Key="F1" Modifiers="None" />
            </OperationElement>
          </Steps>
        </Operation>
        <Operation Event="spmF2Pressed" ModifierKey="None" Name="F2 Key">
          <Steps>
            <OperationElement Type="Hotkey">
              <Hotkey Key="F2" Modifiers="None" />
            </OperationElement>
          </Steps>
        </Operation>
        <Operation Event="spmF3Pressed" ModifierKey="None" Name="F3 Key">
          <Steps>
            <OperationElement Type="Hotkey">
              <Hotkey Key="F3" Modifiers="None" />
            </OperationElement>
          </Steps>
        </Operation>
        <Operation Event="spmF4Pressed" ModifierKey="None" Name="F4 Key">
          <Steps>
            <OperationElement Type="Hotkey">
              <Hotkey Key="F4" Modifiers="None" />
            </OperationElement>
          </Steps>
        </Operation>
        
      </OperationList>
    </ApplicationProfile>
    
  </ApplicationProfileList>
  
  <!-- ═════════════════════════════════════════════════════════════════════ -->
  <!-- RÉSUMÉ DES MAPPINGS AIRADCR v3.0 - SYSTÈME UNIFIÉ                     -->
  <!-- ═════════════════════════════════════════════════════════════════════ -->
  <!-- 
    ┌──────────────────────┬──────────────────┬─────────────────────────────┐
    │ Bouton SpeechMike    │ Raccourci envoyé │ Action AIRADCR              │
    ├──────────────────────┼──────────────────┼─────────────────────────────┤
    │ 🔴 Record            │ Ctrl+Shift+D     │ Démarrer/Terminer (toggle)  │
    │ ⏸️ Pause/Stop        │ Ctrl+Shift+P     │ Pause/Reprise (toggle)      │
    │ ▶️ Play              │ Ctrl+Shift+P     │ Reprise (alias Pause)       │
    │ 📋 Instruction       │ Ctrl+Shift+T     │ Injecter texte brut (Insert)│
    │ 🔧 Programmable 1    │ Ctrl+Shift+S     │ Injecter rapport (EOL)      │
    │ ⏮️ Rewind            │ (Désactivé)      │ Aucune action               │
    │ ⏭️ Fast Forward      │ (Désactivé)      │ Aucune action               │
    │ F1, F2, F3, F4       │ F1, F2, F3, F4   │ Fonction par défaut         │
    └──────────────────────┴──────────────────┴─────────────────────────────┘
    
    SYSTÈME UNIFIÉ: SpeechMike et clavier utilisent EXACTEMENT les mêmes raccourcis!
    Aucune couche intermédiaire, aucun doublon.
  -->
  
</ApplicationControlConfiguration>
